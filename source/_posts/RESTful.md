---
title: RESTful
date: 2018-06-13 10:38:37
tags:  RESTful
keywords: Api接口规范
categories: "技术"
---
### 前后端完全分离的现状
目前这个阶段，大多数的项目的前后端都是完全分离的，他们的沟通都通过API来实现。   
所以API的设计是否科学，是否易于前后端沟通，成了一个很重要的话题。    
于是乎RESTful这种API接口的设计风格，逐渐被广大接受了起来。   
<!--more-->
### 为什么会产生RESTful这种设计风格
在以前，设计API没有那么多的规范，风格。大家写的API都很随意，这样导致了前端请求后端的数据的时候，不知道该从何处请求。  
而且请求回来的数据的类型也都不一致，甚至于请求错误后，都不知道错误的原因是什么？  
这样会导致开发的效率大打折扣。于是乎一种规范的，有层次设计风格在经验中被总结了出来。  
这就是RESTful。
### RESTful的特点
REST的原则主要有以下几个：  
1. 资源与URL
2. 统一资源接口
3. 资源的表述
4. 资源的链接
5. 状态的转移  
#### 资源与URL
前端从后端获取资源是通过url的方式获取，所以后端的url设计是否易懂就很有必要。  
例如，获取某个音乐的信息的路由就可以设置为:  
`https://yuhongjing.com/music/32`    
这样的设计很明显是获取音乐栏目的id为32号的信息，方便前端获取。  
当然这只是一个小例子，真正的url设计还需要考虑分层，分级，分类型，分权限等一系列规范。  
 #### 统一资源接口
 RESTful架构应该遵循统一接口原则，统一接口包含了一组受限的预定义的操作，不论什么样的资源，都是通过使用相同的接口进行资源的访问。  
 接口应该使用标准的HTTP方法如GET，PUT和POST，并遵循这些方法的语义。  
 例如GET表示获取资源，POST表示修改资源，PUT表示插入资源，DELETE表示删除资源等。  
 并且还需要返回http请求的code码和错误信息等。  
 ```
//例如GET请求
GET
* 安全且幂等
* 获取表示
* 变更时获取表示（缓存）
* 200（OK） - 表示已在响应中发出
* 204（无内容） - 资源有空表示
* 301（Moved Permanently） - 资源的URI已被更新
* 303（See Other） - 其他（如，负载均衡）
* 304（not modified）- 资源未更改（缓存）
* 400 （bad request）- 指代坏请求（如，参数错误）
* 404 （not found）- 资源不存在
* 406 （not acceptable）- 服务端不支持所需表示
* 500 （internal server error）- 通用错误响应
* 503 （Service Unavailable）- 服务端当前无法处理请求
```
当然这只是冰山一角，不同的请求有着不同的设计。  
#### 资源的表述
这个就比较简单，也就是返回的资源以什么格式返回。  
RESTful默认所有的返回资源都以JSON的格式返回。  
所以就不要以什么字符串啊，数组啊，xml等格式返回了。  
#### 在URL里边带上版本号
项目的版本总要更新吧，所以需要在url带上你的版本号。  
例如`http://yuhongjing.cn/blog/v1/api/token`  
这里是获取第一版本的token的api，假如需要更改为第二版本。直接更改为:   
`http://yuhongjing.cn/blog/v2/api/token`  
即可，设计好了就是这么简单方便。  
#### 资源的链接
我们知道REST是使用标准的HTTP方法来操作资源的，但仅仅因此就理解成带CURD的Web数据库架构就太过于简单了。  
这种反模式忽略了一个核心概念："超媒体即应用状态引擎（hypermedia as the engine of application state）"。 超媒体是什么?  
当你浏览Web网页时，从一个连接跳到一个页面，再从另一个连接跳到另外一个页面，就是利用了超媒体的概念：把一个个把资源链接起来.  
#### 状态的转移
一句话吧，客户端不应该存有服务器资源的状态，服务器不应该存有客户端应用的状态。  
各司其职，客户端只管理`应用`状态，服务器管理`资源`状态。  
### 总结
现在的项目都是前后端分离，所以RESTful风格的API设计，变得尤为重要。不过，这个得从项目中慢慢去体会。  
 
  