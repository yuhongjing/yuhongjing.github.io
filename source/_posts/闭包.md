---
title: 闭包
date: 2018-03-16 21:18:37
tags: WEB
keywords: 闭包,函数闭包,变量保存
categories: "技术"
---
# 前言
研究了很久，一直也没敢写下这篇文章。闭包，一个非常重要的技术概念。也经常使用，但是一直不是特别清楚它的原理，这一次算是好好的整理一下吧。
<!--more-->
# 什么是闭包
百度百科的解释为“闭包就是能够读取其他函数内部变量的函数”。字面的意思上理解就是闭包是一个函数，能够调用其他函数的变量？但是百度百科接下来还有一句解释，闭包本质就是函数内部与函数外部连接的桥梁。  
这一下就有一点晕了。不愧是百度，搜索的答案总是对新手这么的不友好。 
下面是针对js的闭包解释。  
**JavaScript中的函数运行在它们被定义的作用域中,而不是他们被执行的作用域里**  
```
    var foo = function(){
        var name = "exe";
        return function inner(){
            console.log(name);
        }
    }
    var bar = foo(); //这里得到的是函数inner的引用,相当于只返回了return后面的那一个函数，而且此时并没有执行函数。
    bar(); //这里才开始执行inner函数
```
上面一段代码，有两个特点。第一，return返回的是一个函数。第二，接受函数的是一个变量foo。这就是闭包的特点。  
这样做有什么用吗？当然有用，你可以看见，我定义了一个bar，但是这个bar却可以访问foo下面的函数inner。  
并且，如果我继续定义一个变量bar1，也是赋值foo()，惊人的事情就会发生了,虽然引用同一个函数，但是引用的变量却各不干扰。  
实际情况举一个例子吧。  
```
    var foo = function(){
        var i = 0;
        return function add(){
            i = i + 1;
            console.log(i);
        }
    }
    var bar = foo();
    bar();// i = 1;
    bar();// i = 2;
    var bar1 = foo();
    bar1(); //i = 1;
    bar1(); //i = 2;
```
以上就可以看见闭包的一些特点。
# 什么时候需要使用闭包
还是以js为例，js有一个特别的地方就是，函数内部是可以直接获取全局变量的值，而函数外部却不可以获取函数内部的值。  
如果你需要获取函数内部的局部变量，正常情况下是不能做到的。所以需要通过闭包，在函数内部再定义一个函数！  
这样即可获得函数内部的值。也就是说，当你需要函数内部的局部变量的时候，即可使用闭包。  
# 总结
闭包的特点两个，可以取函数内局部变量，局部变量始终保持在内存中，不会因为调用被自动清除。  
缺点也很明显，保存在内存会导致内存消耗大，而且在外部可以调用内部变量后，容易导致其他错误！  
但是闭包总比定义很多全部变量强吧！哈哈！